---
title: "第7章-拓展基础组件封装思路"
date: 2022-07-12 14:36:39
draft: true
tags: [数据库, RabbitMQ]
categories:
- [数据库, RabbitMQ]
---

### 7-1 本章导航

**一线大厂的MQ组件实现思路和架构设计方案**
- 基础组件封装设计 - 迅速消息发送
- 基础组件封装设计 - 确认消息发送
- 基础组件封装设计 - 批量消息发送
- 基础组件封装设计 - 延迟消息发送
- 基础组件封装设计 - 顺序消息发送
- 基础组件封装设计 - 事务消息发送



### 7-2 一线大厂的MQ组件实现思路和架构设计思路

![image](https://user-images.githubusercontent.com/21000558/178401270-d3ec95b2-be3a-4081-8123-d4f62331352b.png)


**mq组件实现功能点**

- 支持消息高性能的序列化转换，异步发送消息
- 支持消息生产实例与消费实例的链接池化，缓存化，提升性能
- 支持可靠性投递消息，保障消息的100%不丢失
- 支持消费端的幂等操作，避免消费端重复消费的问题
- 支持迅速消息发送模式，在一些日志收集/统计分析等需求下可以保证高性能，超高吞吐量
- 支持延迟消息模式，消息可以延时发送，指定延时时间，用于某些延迟检查，服务限流场景
- 支持事务消息，且100%保障可靠性投递，在金融行业单笔大金额操作时会有此类需求
- 支持顺序消息，保证消息送达消费端的前后顺序，例如下单等复合性操作
- 支持消息补偿，重试，以及快速定位异常/失败消息
- 支持集群消息负载均衡，保障消息落到具体SET集群的负载均衡
- 支持消息路由策略，指定某些消息路由到指定的SET集群


### 7-3 基础MQ消息组件设计思路-1（迅速，确认，批量，延迟)

#### 一、消息发送模式- 迅速消息发送
- 迅速消息是指消息不进行落库存储，不做可靠性的保障
- 在一些非核心信息，日志数据，或者统计分析等场景下比较合适
- 迅速消息的优点就是性能最高，吞吐量大
- 
![image](https://user-images.githubusercontent.com/21000558/178401994-c5ee88eb-24c4-4921-a1fd-5066f384ac7d.png)

#### 二、消息发送模式- 确认消息发送

![image](https://user-images.githubusercontent.com/21000558/178402055-26956592-6dca-4779-b6de-5a9e82bcb8c6.png)

#### 三、消息发送模式- 批量消息发送

![image](https://user-images.githubusercontent.com/21000558/178402314-5872c726-7d3f-405b-aebc-508730bef3fd.png)








### 7-4 基础MQ消息组件设计思路-2（顺序）

### 7-5 基础MQ消息组件设计思路-3(事务) 

### 7-6 消息幂等性保障-消息路由规则架构设计思路

### 7-7 本章小结
